(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{1488:function(e,t,a){e.exports={LEFT_HEADER_WIDTH:"41px",RIGHT_HEADER_WIDTH:"41px"}},1521:function(e,t,a){"use strict";a.r(t);a(29),a(54),a(57),a(88),a(6),a(79),a(180),a(92),a(108),a(35),a(36),a(18),a(10),a(12),a(11),a(7),a(8),a(9),a(15),a(14),a(19),a(17);var n=a(0),r=a.n(n),c=a(5),l=a(394),i=a(131),o=a(1422),u=a(1271),s=a(16),m=a.n(s),f=a(105),d=a(1),v=a(506),p=a(2),b=a(3),S=(a(30),a(122),a(168),a(4)),E=a.n(S),g=a(114),y=a(103);function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,r,c,l,i=[],o=!0,u=!1;try{if(c=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;o=!1}else for(;!(o=(n=c.call(a)).done)&&(i.push(n.value),i.length!==t);o=!0);}catch(e){u=!0,r=e}finally{try{if(!o&&null!=a.return&&(l=a.return(),Object(l)!==l))return}finally{if(u)throw r}}return i}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return j(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return j(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var w=window.Core.Scale,A={scale:E.a.array,onScaleChange:E.a.func,precision:E.a.number};function h(e){var t=e.scale,a=e.onScaleChange,i=e.precision,o=O(Object(c.e)((function(e){return[b.a.getMeasurementUnits(e)]}),c.c),1)[0],u=O(Object(n.useState)(""),2),s=u[0],d=u[1],v=O(Object(n.useState)(""),2),p=v[0],S=v[1],E=O(Object(n.useState)(!1),2),j=E[0],A=E[1],h=O(Object(n.useState)(""),2),C=h[0],M=h[1],N=O(Object(n.useState)(""),2),I=N[0],D=N[1],L=O(Object(n.useState)(!1),2),T=L[0],k=L[1],_=Object(n.useRef)(null),x=Object(n.useRef)(null),R=O(Object(l.a)(),1)[0],U=function(e){return e.filter((function(e){return f.e.includes(e)}))},F=j?U(o.from):o.from,H=j?U(o.to):o.to;Object(n.useEffect)((function(){var e=function(e){return null==e?void 0:e.toFixed((1/i).toString().length-1)};t[0][0]&&(null==_?void 0:_.current)!==document.activeElement&&d(j?w.getFormattedValue(t[0][0],t[0][1],i,!1,!0)||"":e(t[0][0])||""),!t[1][0]||x&&x.current===document.activeElement||(j||"ft-in"===t[1][1]?S(w.getFormattedValue(t[1][0],t[1][1],i,!1,!0)||""):S(e(t[1][0])||""))}),[t,i,x,_,j,T]),Object(n.useEffect)((function(){A(Object(f.j)(i))}),[i]),Object(n.useEffect)((function(){j?(M(f.i[t[0][1]]),D(f.i[t[1][1]])):"ft-in"===t[1][1]?(M(""),D(f.i["ft-in decimal"])):(M(""),D(""))}),[t,j]),Object(n.useEffect)((function(){!V&&J(x.current.value,!1)}),[t[1][1]]),Object(n.useEffect)((function(){if(P||V)!P&&J(_.current.value,!0),!V&&J(x.current.value,!1);else{var e={value:t[0][0],unit:t[0][1]};J(_.current.value,!0,(function(t){e=t.pageScale}));var a={value:t[1][0],unit:t[1][1]};J(x.current.value,!1,(function(e){a=e.worldScale})),G(new w({pageScale:e,worldScale:a}))}}),[j]);var P=!!t[0][0],V=!!t[1][0],K=m()("scale-input",{"invalid-value":!P}),B=m()("scale-input",{"invalid-value":!V}),G=function(e){var t=function(e){return"ft-in"===e?i/12:i};e.pageScale.value&&e.pageScale.value<i&&(e.pageScale.value=t(e.pageScale.unit)),e.worldScale.value&&e.worldScale.value<i&&(e.worldScale.value=t(e.worldScale.unit)),a(e)},J=function(e,a,n){var r=function(e){if(a&&e!==t[0][0]||!a&&e!==t[1][0]){var r=new w({pageScale:{value:a?e:t[0][0],unit:t[0][1]},worldScale:{value:a?t[1][0]:e,unit:t[1][1]}});n?n(r):G(r)}};a?d(e):S(e);var c=e.trim();if(j){var l=a?t[0][1]:t[1][1];if("in"===l){if(f.k.test(c)){var i=Object(f.p)(c);if(i>0)return void r(i)}}else if("ft-in"===l&&f.g.test(c)){var o=Object(f.o)(c);if(o>0)return void r(o)}}else if(a||"ft-in"!==t[1][1]){if(f.d.test(c)){return void r(parseFloat(c)||0)}}else if(f.f.test(c)){var u=Object(f.n)(c);if(u>0)return void r(u)}r(void 0)},W=function(e,a){var n,r;n=a&&e!==t[0][1]?{value:t[0][0]?Object(f.c)(t[0][0],t[0][1],e):t[0][0],unit:e}:{value:t[0][0],unit:t[0][1]},r=a||e===t[1][1]?{value:t[1][0],unit:t[1][1]}:{value:t[1][0]?Object(f.c)(t[1][0],t[1][1],e):t[1][0],unit:e},G(new w({pageScale:n,worldScale:r}))},$=function(e){var a=e?t[0][1]:t[1][1];return j?f.i[a]:"ft-in"===a?f.i["ft-in decimal"]:""},q=function(){k((function(e){return!e}))};return r.a.createElement("div",{className:"custom-scale-container"},r.a.createElement("div",{className:"scale-ratio-input-container"},r.a.createElement("div",{className:"scale-ratio-display"},r.a.createElement("div",{className:"input-wrapper"},r.a.createElement("input",{type:j?"text":"number",min:"0",className:K,value:s,"data-element":"customPageScaleValue",onChange:function(e){return J(e.target.value,!0)},placeholder:$(!0),ref:_,onBlur:q}),r.a.createElement(g.a,{content:"option.measurement.scaleModal.paperUnits"},r.a.createElement("div",{className:"unit-input"},r.a.createElement(y.a,{dataElement:"customPageScaleUnit",items:F,onClickItem:function(e){return W(e,!0)},currentSelectionKey:t[0][1]}))))," = ",r.a.createElement("div",{className:"input-wrapper"},r.a.createElement("input",{type:j||"ft-in"===t[1][1]?"text":"number",min:"0",className:B,value:p,"data-element":"customDisplayScaleValue",onChange:function(e){return J(e.target.value,!1)},placeholder:$(!1),ref:x,onBlur:q}),r.a.createElement(g.a,{content:"option.measurement.scaleModal.displayUnits"},r.a.createElement("div",{className:"unit-input"},r.a.createElement(y.a,{items:H,dataElement:"customDisplayScaleUnit",onClickItem:function(e){return W(e,!1)},currentSelectionKey:t[1][1]})))))),r.a.createElement("div",{className:"warning-messages"},!P&&r.a.createElement("div",null,"".concat(R("option.measurement.scaleModal.incorrectSyntax")," ").concat(C)),!V&&r.a.createElement("div",{className:"world-value-warning"},"".concat(R("option.measurement.scaleModal.incorrectSyntax")," ").concat(I))))}h.propTypes=A;var C=h,M=a(13),N=a(172),I=a(20),D=a(33);a(1488);function L(e){return function(e){if(Array.isArray(e))return _(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||k(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,r,c,l,i=[],o=!0,u=!1;try{if(c=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;o=!1}else for(;!(o=(n=c.call(a)).done)&&(i.push(n.value),i.length!==t);o=!0);}catch(e){u=!0,r=e}finally{try{if(!o&&null!=a.return&&(l=a.return(),Object(l)!==l))return}finally{if(u)throw r}}return i}}(e,t)||k(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){if(e){if("string"==typeof e)return _(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?_(e,t):void 0}}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var x=window.Core.Scale,R="custom",U="preset",F=function(){var e,t,a=Object(c.d)(),s=T(Object(l.a)(),1)[0],S=Object(v.a)(),E=S.annotations,O=S.selectedTool,j=T(Object(c.e)((function(e){return[b.a.isElementDisabled(e,M.a.SCALE_MODAL),b.a.isElementOpen(e,M.a.SCALE_MODAL),b.a.isElementHidden(e,M.a.SCALE_MODAL),b.a.getCurrentToolbarGroup(e),b.a.getSelectedScale(e),b.a.getActiveToolName(e),b.a.getIsAddingNewScale(e),b.a.getMeasurementScalePreset(e),b.a.getCalibrationInfo(e),b.a.getIsMultipleScalesMode(e)]})),10),w=j[0],A=j[1],h=j[2],k=j[3],_=j[4],F=j[5],H=j[6],P=j[7],V=j[8],K=V.tempScale,B=V.isFractionalUnit,G=j[9],J=T(Object(n.useState)(!1),2),W=J[0],$=J[1],q=T(Object(n.useState)(f.r[f.a.DECIMAL][0]),2),z=q[0],Q=q[1],X=T(Object(n.useState)(R),2),Y=X[0],Z=X[1],ee=T(Object(n.useState)(P[f.b.METRIC][0]),2),te=ee[0],ae=ee[1],ne=T(Object(n.useState)(new x("")),2),re=ne[0],ce=ne[1],le=T(Object(n.useState)(!1),2),ie=le[0],oe=le[1],ue=Object.keys(d.a.getScales()).length;Object(n.useEffect)((function(){f.r[be].includes(z)||Q(f.r[be][0]),ae(P[ve][0])}),[W]),Object(n.useEffect)((function(){Z(R),ce(new x(_.getScaleRatioAsArray()));var e=d.a.getScalePrecision(_);if(e){var t=Object(f.j)(e);$(t);var a=f.r[pe(t)].find((function(t){return t[1]===e}));Q(a),setTimeout((function(){oe(!1)}))}}),[_]),Object(N.a)((function(){if(Y===R)ce(te[1]);else{var e=f.s[te[0]];e&&e!==z&&Q(e)}}),[Y]),Object(N.a)((function(){"toolbarGroup-Measure"===k&&se()}),[k]),Object(n.useEffect)((function(){var e=f.s[te[0]];e&&Y===U&&Q(e)}),[te]),Object(n.useEffect)((function(){!h&&K&&(ce(new x(K)),a(p.a.updateCalibrationInfo({isCalibration:!1})),$(B))}),[h]),Object(n.useEffect)((function(){oe(!0)}),[z,re,te,Y]),Object(n.useEffect)((function(){A&&H&&!K&&(Z(R),ce(f.l),$(!1),Q(f.r[f.a.DECIMAL][0]))}),[A,H]);var se=function(){a(p.a.closeElement(M.a.SCALE_MODAL))},me=function(){var e=function(e,t){var a=e,n=z[1];return W?("ft-in"===t&&(n/=12),a=Math.round(a/n)*n):"ft-in"!==t&&(a=a.toFixed((1/n).toString().length-1)),1*a};if(de){var t=re.getScaleRatioAsArray();return t[0][0]=e(t[0][0],t[0][1]),t[1][0]=e(t[1][0],t[1][1]),t}return te[1].toString()},fe=m()("Modal","ScaleModal",{open:!h,closed:h}),de=Y===R,ve=W?f.b.IMPERIAL:f.b.METRIC,pe=function(e){return e?f.a.FRACTIONAL:f.a.DECIMAL},be=pe(W),Se=!de||re.isValid(),Ee=de&&!(f.e.includes(null===(e=re.pageScale)||void 0===e?void 0:e.unit)&&f.e.includes(null===(t=re.worldScale)||void 0===t?void 0:t.unit));return!w&&r.a.createElement(i.a,{onSwipedUp:se,onSwipedDown:se,preventDefaultTouchmoveEvent:!0},r.a.createElement(o.a,{locked:!h},r.a.createElement("div",{className:fe,"data-element":M.a.SCALE_MODAL},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"header-container"},r.a.createElement("div",{className:"header"},r.a.createElement("p",null,s("option.measurementOption.scale")),r.a.createElement(I.a,{className:"scaleModalCloseButton",title:"action.close",img:"ic_close_black_24px",onClick:se}))),r.a.createElement("div",{className:"content-container"},r.a.createElement("div",{className:"scaleSetting"},r.a.createElement("div",{className:"custom-option-wrapper"},r.a.createElement("div",{className:"custom-scale-option"},r.a.createElement(u.a,{"data-element":"customScaleOption",radio:!0,name:"setting",onChange:function(){return Z(R)},checked:de,label:"".concat(s("option.measurement.scaleModal.custom"),":"),center:!0})),de&&r.a.createElement("button",{"data-element":"calibrate",className:"calibrate-btn",onMouseDown:function(){var e;d.a.setToolMode("AnnotationCreateCalibrationMeasurement");var t=de?(null===(e=re.worldScale)||void 0===e?void 0:e.unit)||"":te[1].worldScale.unit;a(p.a.updateCalibrationInfo({isCalibration:!0,previousToolName:F,defaultUnit:t})),a(p.a.setIsElementHidden(M.a.SCALE_MODAL,!0))}},s("option.measurement.scaleModal.calibrate"))),de?r.a.createElement(C,{scale:re.getScaleRatioAsArray(),onScaleChange:ce,precision:z[1]}):r.a.createElement("div",{className:"block"}),r.a.createElement(u.a,{"data-element":"presetScaleOption",radio:!0,onChange:function(){return Z(U)},name:"setting",checked:!de,label:"".concat(s("option.measurement.scaleModal.preset"),":"),center:!0}),!de&&r.a.createElement("div",{className:"scaleModal__preset-container"},r.a.createElement("div",{className:"selector"},r.a.createElement(y.a,{dataElement:"presetScales",items:P[ve].map((function(e){return e[0]})),currentSelectionKey:te[0],onClickItem:function(e,t){return ae(P[ve][t])}})))),r.a.createElement("div",{className:"precision-container"},r.a.createElement("div",{className:"precision-selector"},r.a.createElement("div",{className:"precision-title"},s("option.shared.precision"),":"),r.a.createElement("div",{className:"selector"},r.a.createElement(y.a,{dataElement:"scalePrecisions",items:f.r[be].map((function(e){return e[0]})),currentSelectionKey:z[0],onClickItem:function(e,t){return Q(f.r[be][t])}}))),r.a.createElement(g.a,{content:s("option.measurement.scaleModal.fractionUnitsTooltip")},r.a.createElement("div",null,r.a.createElement(u.a,{isSwitch:!0,leftLabel:!0,id:"scale-modal-fractional-units",label:s("option.measurement.scaleModal.fractionalUnits"),checked:W,onChange:function(){$((function(e){return!e}))},disabled:Ee}))))),r.a.createElement("div",{className:"footer"},r.a.createElement(D.a,{type:"button",onClick:function(){var e,t;e=[_],t=new x(me(),z[1]),d.a.replaceScales(e,t),se()},className:"scale-update",dataElement:"updateScale",disabled:H||!Se||!ie},s("action.update")),r.a.createElement("button",{onClick:function(){var e,t;e=new x(me(),z[1]),t=[].concat(L(E),[O]),d.a.createAndApplyScale(e,t),se()},className:"scale-create","data-element":"createScale",disabled:!Se||!G&&ue||!H&&!ie},s("action.create")))))))};t.default=F}}]);
//# sourceMappingURL=15.chunk.js.map